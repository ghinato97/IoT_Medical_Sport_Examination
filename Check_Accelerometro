from  MyMQTT_TS import *
import json
import time

class Check_Accelerometer:
    def __init__(self):
        conf=json.load(open("Catalog.json",'r'))
        broker=conf["broker"]['IpAddress']
        port=conf["broker"]['port']
        
        username=conf['thingSpeak']["username"]
        password=conf['thingSpeak']["password"]
        z=conf['thingSpeak']["channelID"]
        clientID=username
        
        self.topic='channels/'+str(1789105)+'/subscribe'
        self.client=MyMQTT(clientID,broker,port,username,password,self)
     
    def start (self):
        self.client.start()
        self.client.mySubscribe(self.topic)
        
    def stop (self):
        self.client.stop()
        
    def notify(self,topic,msg):
        print(msg)
        
if __name__=='__main__':
    Check_Accelerometer()
    Check_Accelerometer().start()
    while True:
        time.sleep(1)
    Check_Accelerometer().stop()
          